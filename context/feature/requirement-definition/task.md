# 備品在庫管理システム タスク一覧

## 📋 概要

複数支店を持つ介護事業者向け備品在庫管理システムの新規開発プロジェクト。Webブラウザ利用を前提とし、PWA・Node.js・Supabase構成で、権限管理・在庫管理・操作ログ・グラフ表示等の機能を実装する。

## ✅ タスクリスト

### フェーズ1: プロジェクト初期設定・基盤構築

1. **リポジトリ初期化・CI/CD設定**
    - 概要: GitHubリポジトリ、.gitignore、CI/CD（GitHub Actions等）初期設定
    - 完了条件:
        - [ ] mainブランチでリポジトリ管理
        - [ ] .gitignore・README整備
        - [ ] CIでlint/test/buildが自動実行
    - 動作確認:
        - [ ] push時にCIが正常動作
    - メモ: セキュリティ要件は後日追加

2. **PWA/Next.jsプロジェクト雛形作成**
    - 概要: Next.js(TypeScript)でPWA対応の雛形作成
    - 完了条件:
        - [ ] PWAとしてmanifest/ServiceWorker設定
        - [ ] lint/test/buildが通る
    - 動作確認:
        - [ ] `pnpm dev`で起動・PWAインストール可

3. **バックエンド(Node.js/Express)雛形作成**
    - 概要: APIサーバ雛形、Supabase接続設定
    - 完了条件:
        - [ ] Expressサーバ起動
        - [ ] Supabase接続確認
    - 動作確認:
        - [ ] API疎通テスト

### フェーズ2: 認証・権限管理

4. **ユーザー認証（JWT）実装**
    - 概要: ログイン/ログアウト、JWT発行・検証
    - 完了条件:
        - [ ] ログイン/ログアウトAPI
        - [ ] JWTによる認証
    - 動作確認:
        - [ ] テストユーザーで認証確認

5. **権限管理（API/DB）実装**
    - 概要: ロールごとのAPI/DBアクセス制御（Supabase RLS含む）
    - 完了条件:
        - [ ] APIでロール判定・制御
        - [ ] Supabase RLS設定
    - 動作確認:
        - [ ] 各権限でアクセス制御確認

### フェーズ3: 基本機能実装

6. **支店・ユーザー管理機能**
    - 概要: 支店情報・ユーザー情報のCRUD、論理削除
    - 完了条件:
        - [ ] 支店/ユーザーの追加・編集・論理削除
    - 動作確認:
        - [ ] CRUD操作・論理削除履歴確認

7. **在庫アイテム管理機能**
    - 概要: 在庫アイテムのCRUD、単位・金額バリデーション、論理削除
    - 完了条件:
        - [ ] 在庫アイテムの追加・編集・論理削除
        - [ ] 単位・金額バリデーション（半角数字4桁/整数/日本円）
    - 動作確認:
        - [ ] CRUD・バリデーション・履歴確認

8. **在庫数増減・履歴管理**
    - 概要: 在庫数の増減、履歴記録、閾値アラート
    - 完了条件:
        - [x] 在庫数増減API・画面（Web画面から増減・APIで履歴記録・閾値アラート返却）
        - [x] 履歴記録・閾値アラート（items_historyテーブル設計・RLS・uuid化・Web画面でアラート表示）
    - 動作確認:
        - [x] 増減・アラート・履歴表示（Web画面で閾値アラート・履歴が正しく表示されることを確認）
    - 備考: 2025/08/17 機能実装・動作確認済み。API/DB/画面の型統一・RLS・アラートUIも対応済み。

9. **操作ログ管理・CSVエクスポート**
    - 概要: 操作ログ記録・閲覧・CSVエクスポート
    - 完了条件:
        - [ ] 操作ログの記録・閲覧
        - [ ] CSVエクスポート
    - 動作確認:
        - [ ] ログ・CSV出力確認

10. **グラフ・分析画面実装**
    - 概要: 過去3ヶ月分の在庫増減数を棒グラフで表示
    - 完了条件:
        - [ ] 棒グラフ表示
    - 動作確認:
        - [ ] グラフ表示・データ整合性

### フェーズ4: UI/UX・テスト・運用

11. **UI/UX改善・バリデーション強化**
    - 概要: 入力補助・エラーメッセージ・アクセシビリティ対応
    - 完了条件:
        - [ ] UI/UXレビュー・改善
    - 動作確認:
        - [ ] 手動・自動テスト

12. **自動テスト・E2Eテスト整備**
    - 概要: ユニット・結合・E2Eテスト
    - 完了条件:
        - [ ] 主要機能のテストコード
    - 動作確認:
        - [ ] `pnpm test`で全テスト通過

13. **運用・保守設計・ドキュメント整備**
    - 概要: 運用手順・管理者向けマニュアル作成
    - 完了条件:
        - [ ] ドキュメント整備
    - 動作確認:
        - [ ] ドキュメントレビュー

## ❓ 未解決の課題・確認事項

- セキュリティ要件（パスワードリセット、2段階認証等）は今後提案・決定
- グラフ・分析画面の詳細要件は今後拡張可能性あり
- CSVエクスポートの大規模データ対応は今後検討
- Supabase以外のDB切り替え時の移行手順・設計方針は要検討

## 🔗 関連ドキュメント
- 実装要件: [specification.md](./specification.md)
- 設計方針: [design-doc.md](./design-doc.md)
